<html>
  <head>
    <title>Glaciares Alto Maipo</title>

    <script src="https://unpkg.com/deck.gl@^7.0.0/dist.min.js"></script>
    <script src="https://unpkg.com/shapefile"></script>
    <script src="https://unpkg.com/proj4js@1.3.4/dist/proj4.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v0.50.0/mapbox-gl.js"></script>

    <style type="text/css">
      body {
        width: 100vw;
        height: 100vh;
        margin: 5vw 10vw 0 10vw;
      }
      #tooltip:empty {
        display: none;
      }
      #tooltip {
        font-family: Helvetica, Arial, sans-serif;
        font-size: 11px;
        position: absolute;
        padding: 4px;
        margin: 8px;
        background: rgba(0, 0, 0, 0.8);
        color: #fff;
        max-width: 300px;
        font-size: 10px;
        z-index: 9;
        pointer-events: none;
      }
      #mapContainer{
        width: 80vw;
        height: 400px;
      }
      #example-table{
        width: 80vw;
        height: auto;
        margin-top: 5vw;
      }
    </style>
  </head>

  <body>
    <div id="tooltip"></div>
    <div id="mapContainer"></div>
    <div id="example-table"></div>
  </body>

  <script type="text/javascript">

    proj4.defs("EPSG:32617", "+proj=utm +zone=17 +ellps=WGS84 +datum=WGS84 +units=m +no_defs");

    const {DeckGL, GeoJsonLayer} = deck;

    const glacierLayer = new GeoJsonLayer({
      id: 'glacier-geojson',
      data: 'https://obascunan.github.io/glaciaresAltoMaipo/glaciares_rm/glaciares_rm.geojson',
      opacity: 1,
      stroked: false,
      filled: false,
      lineWidthMinPixels: 1,
      parameters: {
        depthTest: false
      },

      getLineColor: [300,103,23],
      getLineWidth: 5,

    });

    const deckgl = new DeckGL({
      mapboxApiAccessToken: 'pk.eyJ1Ijoibm90Ymxvb20iLCJhIjoiY2pyaWVua3gzMDA4ODN5bXl0ZTU1ejgyOCJ9.e6_za1_NqG7xddmPCXxBAQ',
      mapStyle: 'mapbox://styles/mapbox/dark-v9',
      container: 'mapContainer',
      longitude: -33.49,
      latitude: -70.31,
      zoom: 6,
      minZoom: 5,
      maxZoom: 15,
      pitch: 40.5,
      layers: [glacierLayer]
    });


    let data = null;

    const COLOR_RANGE = [
      [1, 152, 189],
      [73, 227, 206],
      [216, 254, 181],
      [254, 237, 177],
      [254, 173, 84],
      [209, 55, 78]
    ];

    function renderLayers () {
      const glacier = new getGlacierLayer(glacierData);
      deckgl.setProps({
        layers: [glacier]
      });
    }

    function getGPSPos(d){
        var p = proj4("EPSG:32617", 'WGS84', [d.properties.X, d.properties.Y]);
        p[2] = 0;
        return p;
    }




  </script>
</html>
